<?xml version="1.0" encoding="UTF-8" ?>	 
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" 
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
	
<mapper namespace="com.ricex.cartracker.data.mapper.OBDReadingMapper">
    
    <cache />
    
    <resultMap id="obdReadingResultMap" type="OBDReading">
        <id property="id" column="ID" />
        <result property="airIntakeTemperature" column="AIR_INTAKE_TEMP" />
        <result property="ambientAirTemperature" column="AMBIENT_AIR_TEMP" />
        <result property="engineCoolantTemperature" column="ENGINE_COOLANT_TEMP" />
        <result property="oilTemperature" column="OIL_TEMP" />
        <result property="engineRPM" column="ENGINE_RPM" />
        <result property="speed" column="SPEED" />
        <result property="massAirFlow" column="MASS_AIR_FLOW" />
        <result property="throttlePosition" column="THROTTLE_POSITION" />
        <result property="fuelType" column="FUEL_TYPE" />
        <result property="fuelLevel" column="FUEL_LEVEL" />
        <result property="readingId" column="READING_ID" />     
        
        <association property="reading" column="READING_ID" javaType="Reading" select="com.ricex.cartracker.data.mapper.ReadingMapper.get" />        
    </resultMap>
    
     <select id="get" resultMap="obdReadingResultMap" parameterType="long">
        SELECT OBD_READING.* FROM OBD_READING
        WHERE OBD_READING.ID = #{id}
    </select>
    
    <select id="getAll" resultMap="obdReadingResultMap">
        SELECT OBD_READING.* FROM OBD_READING
    </select>
    
    <select id="getForReading" resultMap="obdReadingResultMap" parameterType="long">
        SELECT OBD_READING.* FROM OBD_READING
        WHERE OBD_READING.READING_ID = #{readingId}
    </select>   
    
    <insert id="create" useGeneratedKeys="true" keyProperty="id">
    	INSERT INTO OBD_READING ( AIR_INTAKE_TEMP,
    							  AMBIENT_AIR_TEMP,
    							  ENGINE_COOLANT_TEMP,
    							  OIL_TEMP,
    							  ENGINE_RPM,
    							  SPEED,
    							  MASS_AIR_FLOW,
    							  THROTTLE_POSITION,
    							  FUEL_TYPE,
    							  FUEL_LEVEL,
    							  READING_ID)
		VALUES 				    ( #{airIntakeTemperature},
								  #{ambientAirTemperature},
								  #{engineCoolantTemperature},
								  #{oilTemperature},
								  #{engineRPM},
								  #{speed},
								  #[massAirFlow},
								  #{throttlePosition},
								  #{fuelType},
								  #{fuelLevel},
								  #{readingId} )		
    </insert>
    
    <update id="update">
        UPDATE OBD_READING SET
			AIR_INTAKE_TEMP = 	#{airIntakeTemperature},
			AMBIENT_AIR_TEMP = 	#{ambientAirTemperature},
			ENGINE_COOLANT_TEMP #{engineCoolantTemperature},
			OIL_TEMP = 			#{oilTemperature},
			ENGINE_RPM = 		#{engineRPM},
			SPEED = 			#{speed},
			MASS_AIR_FLOW = 	#{massAirFlow},
			THROTTLE_POSITION = #{throttlePosition},
			FUEL_TYPE = 		#{fuelType},
			FUEL_LEVEL = 		#{fuelLeve},
			READING_ID = 		#{readingId}
       	WHERE OBD_READING.ID =  #{id}
        
    </update>
    
    
</mapper>
